# 1, 3번 테이블 JOIN
# 2022-01 판매도서

WITH M AS (
    SELECT B.AUTHOR_ID,
        B.CATEGORY,
        SUM(B.PRICE * S.SALES) AS TOTAL
    FROM BOOK_SALES S
    JOIN BOOK B
    ON S.BOOK_ID = B.BOOK_ID
    WHERE S.SALES_DATE LIKE '2022-01%'
    GROUP BY B.AUTHOR_ID, B.CATEGORY
)

SELECT 
    M.AUTHOR_ID,
    A.AUTHOR_NAME,
    M.CATEGORY,
    M.TOTAL AS TOTAL_SALES
FROM M
JOIN AUTHOR A
ON M.AUTHOR_ID = A.AUTHOR_ID
ORDER BY A.AUTHOR_ID, M.CATEGORY DESC;











